<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Reproject coordinates. — reproj.sc • reproj</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Reproject coordinates. — reproj.sc"><meta property="og:description" content="Reproject coordinates from a matrix or data frame by explicitly specifying the
'source' and 'target' projections."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reproj</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/hypertidy/reproj/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Reproject coordinates.</h1>
    <small class="dont-index">Source: <a href="https://github.com/hypertidy/reproj/blob/HEAD/R/reproj-external-types.R" class="external-link"><code>R/reproj-external-types.R</code></a>, <a href="https://github.com/hypertidy/reproj/blob/HEAD/R/reproj.R" class="external-link"><code>R/reproj.R</code></a></small>
    <div class="hidden name"><code>reproj.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Reproject coordinates from a matrix or data frame by explicitly specifying the
'source' and 'target' projections.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for sc</span></span>
<span><span class="fu">reproj</span><span class="op">(</span><span class="va">x</span>, target <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, source <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mesh3d</span></span>
<span><span class="fu">reproj</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span>, <span class="va">...</span>, source <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for quadmesh</span></span>
<span><span class="fu">reproj</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span>, <span class="va">...</span>, source <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for triangmesh</span></span>
<span><span class="fu">reproj</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span>, <span class="va">...</span>, source <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">reproj</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span>, <span class="va">...</span>, source <span class="op">=</span> <span class="cn">NULL</span>, four <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">reproj</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span>, <span class="va">...</span>, source <span class="op">=</span> <span class="cn">NULL</span>, four <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for data.frame</span></span>
<span><span class="fu">reproj</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span>, <span class="va">...</span>, source <span class="op">=</span> <span class="cn">NULL</span>, four <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">reproj_xy</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span>, <span class="va">...</span>, source <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">reproj_xyz</span><span class="op">(</span><span class="va">x</span>, <span class="va">target</span>, <span class="va">...</span>, source <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>coordinates</p></dd>


<dt>target</dt>
<dd><p>target specification (PROJ.4 string or epsg code)</p></dd>


<dt>...</dt>
<dd><p>arguments passed to <code><a href="https://rdrr.io/pkg/proj4/man/transform.html" class="external-link">proj4::ptransform()</a></code></p></dd>


<dt>source</dt>
<dd><p>source specification (PROJ.4 string or epsg code)</p></dd>


<dt>four</dt>
<dd><p>if <code>TRUE</code>, and PROJ version 6 is available return four columns xyzt (not just three xyz)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>numeric matrix of the transformed coordinates, either 2, 3, or 4 columns depending on the
shape of the input, or the argument 'four' in <code>reproj()</code>. Use <code>reproj_xy()</code> or
<code>reproj_xyz()</code> for those specific 2- and 3-column cases.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>We currently use the proj4 package.</p>
<p>The <code>reproj()</code> and related functions drive <code><a href="https://rdrr.io/pkg/proj4/man/transform.html" class="external-link">proj4::ptransform()</a></code> and sort out
the requirements for it so that we can simply give coordinates in data frame
or matrix form, with a source projection and a target projection.</p>
<p>If using PROJ, reproj can pass in a wider variety of source and target
strings, not just "proj4string" and we are completely subject to the new
rules and behaviours of the PROJ library. We always assume "visualization
order", i.e. longitude then latitude, easting then northing (as X, Y).</p>
<p>The basic function <code>reproj()</code> takes input in generic form (matrix or data
frame) and returns a 3-column matrix, by
transforming from map projection specified by the  <code>source</code> argument to that
specified by the <code>target</code> argument.  Only column order is respected, column
names are ignored.</p>
<p>This model of working also allows adding methods for specific data formats
that already carry a suitable <code>source</code> projection string. Currently we
support types from the silicate and quadmesh and rgl packages, and only the
<code>target</code> string need be specified.</p>
<p>This model has obvious flexibility, for packages to import the generic and
call it with the correct <code>source</code> (from the data format) and the <code>target</code>
from user, or process controlled mechanism.</p>
<p>The <code>source</code> argument must be named, and if it is not present a light check
is made that the source data could be "longitude/latitude" and transformation
to <code>target</code> is applied (this can be controlled by setting options).</p>
<p>The function <code>reproj()</code> always returns a 3-column matrix <em>unless</em> <code>four = TRUE</code>, and <code><a href="https://rdrr.io/pkg/PROJ/man/ok_proj6.html" class="external-link">PROJ::ok_proj6()</a></code> is <code>TRUE</code> and then a 4-column matrix is returned.</p>
<p>Functions <code>reproj_xy()</code> and <code>reproj_xyz()</code> are helpers for <code>reproj()</code> and always
return 2- or 3-column matrix respectively.</p>
<p>Note that any integer input for <code>source</code> or <code>target</code> will be formatted to a
character string like "EPSG:&lt;integer_code&gt;" as a simple convenience. Note that
there are other authorities besides EPSG, so the pattern "AUTH:code" is a general
one and you should really be explicit.</p>
<p>Until recently the <code>proj4</code> package was the only one available for generic
data that will transform between arbitrary coordinate systems specified by
<em>source</em> and <em>target</em> coordinate systems and with control over 'xy' versus
'xyz' input and output.  This package adds some further features by wrapping
the need to convert longitude/latitude data to or from radians.</p>
<p>Other R packages for transforming coordinates are geared toward data
that's in a particular format. It's true that only GDAL provides the full
gamut of available geographic map projections, but this leaves a huge variety
of workflows and applications that don't need that level of functionality.</p>
    </div>
    <div id="dependencies">
    <h2>Dependencies</h2>
    

<ul><li><p>The <a href="https://CRAN.r-project.org/package=PROJ" class="external-link">PROJ</a> package is a stub atm
and is not used.</p></li>
</ul><p>The proj4 package works perfectly well with the PROJ-lib at versions 4, 5, 6,
or 7 and if this is preferred reproj can be set to ignore the PROJ R package
(see
<a href="https://hypertidy.github.io/reproj/reference/reproj-package.html" class="external-link">reproj-package</a>).</p>
    </div>
    <div id="global-options">
    <h2>Global options</h2>
    

<div class="section">
<h3 id="assuming-longitude-latitude-input">Assuming longitude/latitude input<a class="anchor" aria-label="anchor" href="#assuming-longitude-latitude-input"></a></h3>


<p>The behaviour is controlled by user-settable options which on start up are
<code>reproj.assume.longlat = TRUE</code> and
<code>reproj.default.longlat = "OGC:CRS84"</code>.</p>
<p>If the option <code>reproj.assume.longlat</code> is set to FALSE then the <code>source</code>
argument must be named explicitly, i.e. <code>reproj(xy, t_srs, source = s_srs)</code>,
this is to help catch mistakes being made. The <code>target</code> is the second
argument in <code>reproj</code> though it is the third argument in <code><a href="https://rdrr.io/pkg/proj4/man/transform.html" class="external-link">proj4::ptransform</a></code>.
This function also converts to radians on input or output as required.</p>
<p>If the option <code>reproj.assume.longlat</code> is set to TRUE and the input data
appear to be sensible longitude/latitude values, then the value of
<code>reproj.default.longlat</code> is used as the assumed source projection.</p>
</div>

<div class="section">
<h3 id="controlling-use-or-proj-or-proj-">Controlling use or PROJ or proj4<a class="anchor" aria-label="anchor" href="#controlling-use-or-proj-or-proj-"></a></h3>


<p>See <a href="reproj-package.html">reproj-package</a> for another option set <code>reproj.mock.noproj6</code> for package
testing for expert use.</p>
</div>

    </div>
    <div id="warning">
    <h2>Warning</h2>
    


<p>There are a number of limitations to the PROJ library please use at your own
risk. The sf package provides a better supported facility. The libproj package
will be used if it makes it to CRAN.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">reproj</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">147</span>, <span class="op">-</span><span class="fl">42</span><span class="op">)</span>, target <span class="op">=</span> <span class="st">"+proj=laea +datum=WGS84"</span>,</span></span>
<span class="r-in"><span>                         source <span class="op">=</span> <span class="st">"OGC:CRS84"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           x_       y_  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 5969744 -9803200 0</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael D. Sumner.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

